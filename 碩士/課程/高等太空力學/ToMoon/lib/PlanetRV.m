function [a, ecc, incl, LongP, Omega, LLong, theta] = PlanetRV(PlanetNum,WhichEpoch,JD)
% declaim
% Semi .or. axis= a
% eccentricity=   ecc
% inclination=    incl
% longitude of perihelion= LongP
% ecliptic long of ascending node= Omega
% True longitude= LLong
% theta(true anomaly) =LLong_deg-LongP_deg ;
% L_Omega=LLong_deg-Omega_deg;


% ---------------- Approximate TTDB with Tut1 -----------------
Tut1 = ( JD - 2451545.0) / 36525.0;
Tut12= Tut1*Tut1;
Tut13= Tut12*Tut1;

if ( WhichEpoch == 'J20' )
    %! --------- Mean equinox of J2000 in radians (XYZ) --------
    
    
    if (PlanetNum==1)
        % Mercury
        a    =  0.387098310;
        ecc  =  0.20563175 +    0.000020406*Tut1 - 0.0000000284*Tut12 - 0.00000000017*Tut13;
        incl =  0.12226007 -    0.000103875*Tut1 + 0.0000000141*Tut12 + 0.00000000072*Tut13;
        LongP=  1.35186430 +    0.002772705*Tut1 - 0.0000002344*Tut12 + 0.00000000068*Tut13;
        Omega=  0.84353321 -    0.002189043*Tut1 - 0.0000015416*Tut12 - 0.00000000342*Tut13;
        LLong=  4.40260885 + 2608.790314157*Tut1 - 0.0000000934*Tut12 + 0.00000000003*Tut13;
    elseif (PlanetNum==2)
        %Venus
        a    =  0.723329820;
        ecc  =  0.00677188 -    0.000047766*Tut1 + 0.0000000975*Tut12 + 0.00000000044*Tut13;
        incl =  0.05924803 -    0.000014954*Tut1 - 0.0000005662*Tut12 + 0.00000000017*Tut13;
        LongP=  2.29621986 +    0.000084903*Tut1 - 0.0000241260*Tut12 - 0.00000009306*Tut13;
        Omega=  1.33831707 -    0.004852155*Tut1 - 0.0000024881*Tut12 - 0.00000000346*Tut13;
        LLong=  3.17614670 + 1021.328554621*Tut1 + 0.0000000288*Tut12 - 0.00000000003*Tut13;
    elseif (PlanetNum==3)
        % Earth
        a    =  1.000001018;
        ecc  =  0.01670862 -    0.000042037*Tut1 - 0.0000001236*Tut12 + 0.00000000004*Tut13;
        incl =  0.00000000 +    0.000227846*Tut1 - 0.0000001625*Tut12 - 0.00000000059*Tut13;
        LongP=  1.79659565 +    0.005629659*Tut1 + 0.0000026225*Tut12 + 0.00000000834*Tut13;
        Omega=  0.0;
        LLong=  1.75347032 +  628.307584919*Tut1 - 0.0000000991*Tut12 + 0.00000000000*Tut13;
    elseif (PlanetNum==4)
        % Mars
        a    =  1.523679342;
        ecc  =  0.09340062 +    0.000090483*Tut1 - 0.0000000806*Tut12 - 0.00000000035*Tut13;
        incl =  0.03228381 -    0.000142208*Tut1 - 0.0000003936*Tut12 - 0.00000000047*Tut13;
        LongP=  5.86535757 +    0.007747339*Tut1 - 0.0000030231*Tut12 + 0.00000000524*Tut13;
        Omega=  0.86495189 -    0.005148453*Tut1 - 0.0000111689*Tut12 - 0.00000003740*Tut13;
        LLong=  6.20348092 +  334.061243148*Tut1 + 0.0000000456*Tut12 - 0.00000000005*Tut13;
    elseif (PlanetNum==5)
        % Jupiter
        a    =  5.202603191 +   0.0000001913*Tut1;
        ecc  =  0.04849485 +    0.000163244*Tut1 - 0.0000004719*Tut12 - 0.00000000197*Tut13;
        incl =  0.02274635 -    0.000034683*Tut1 + 0.0000005791*Tut12 + 0.00000000161*Tut13;
        LongP=  0.25012853 +    0.003762101*Tut1 + 0.0000126104*Tut12 - 0.00000008011*Tut13;
        Omega=  1.75343528 +    0.003083697*Tut1 + 0.0000157755*Tut12 - 0.00000012273*Tut13;
        LLong=  0.59954650 +   52.969096509*Tut1 - 0.0000014837*Tut12 + 0.00000000007*Tut13;
    elseif (PlanetNum==6)
        % Saturn
        a    =  9.554909596 -   0.0000021389*Tut1;
        ecc  =  0.05550862 -    0.000346818*Tut1 - 0.0000006456*Tut12 + 0.00000000338*Tut13;
        incl =  0.04343912 +    0.000044532*Tut1 - 0.0000008557*Tut12 + 0.00000000031*Tut13;
        LongP=  1.62414732 +    0.009888156*Tut1 + 0.0000092169*Tut12 + 0.00000008521*Tut13;
        Omega=  1.98383764 -    0.004479648*Tut1 - 0.0000032018*Tut12 + 0.00000000623*Tut13;
        LLong=  0.87401675 +   21.329909545*Tut1 + 0.0000036659*Tut12 - 0.00000000033*Tut13;
    elseif (PlanetNum==7)
        % Uranus
        a    = 19.218446062 -   0.0000000372*Tut1 + 0.00000000098*Tut12;
        ecc  =  0.04629590 -    0.000027337*Tut1  + 0.0000000790*Tut12 + 0.00000000025*Tut13;
        incl =  0.01349482 -    0.000029442*Tut1  + 0.0000000609*Tut12 + 0.00000000028*Tut13;
        LongP=  3.01950965 +    0.001558939*Tut1  - 0.0000016528*Tut12 + 0.00000000721*Tut13;
        Omega=  1.29164744 +    0.001294094*Tut1  + 0.0000070756*Tut12 + 0.00000000182*Tut13;
        LLong=  5.48129387 +    7.478159856*Tut1  - 0.0000000848*Tut12 + 0.00000000010*Tut13;
    elseif (PlanetNum==8)
        % Neptune
        a    = 30.110386869 -   0.0000001663*Tut1  + 0.00000000069*Tut12;
        ecc  =  0.00898809 +    0.000006408*Tut1   - 0.0000000008*Tut12;
        incl =  0.03089149 +    0.000003939*Tut1   + 0.0000000040*Tut12 - 0.00000000000*Tut13;
        LongP=  0.83991686 +    0.000508915*Tut1   + 0.0000012306*Tut12 - 0.00000000000*Tut13;
        Omega=  2.30006570 -    0.000107601*Tut1   - 0.0000000382*Tut12 - 0.00000000136*Tut13;
        LLong=  5.31188628 +    3.813303564*Tut1   + 0.0000000103*Tut12 - 0.00000000003*Tut13;
    elseif (PlanetNum==9)
        % Pluto
        a    = 39.53758;
        ecc  =  0.250877;
        incl =  0.2990156;
        LongP=  3.920268;
        Omega=  1.926957;
        LLong=  3.8203049;
    end
end
%!*

if ( WhichEpoch == 'ODA' )
    %! ----------- Mean equinox of date in radians (XYZ) -----------
    if (PlanetNum==1)
        % Mercury
        a    =  0.387098310;
        ecc  =  0.20563175 +    0.000020406*Tut1 - 0.0000000284*Tut12 - 0.00000000017*Tut13;
        incl =  0.12226007 +    0.000031791*Tut1 - 0.0000003157*Tut12 + 0.00000000093*Tut13;
        LongP=  1.35186430 +    0.027165657*Tut1 + 0.0000051643*Tut12 + 0.00000000098*Tut13;
        Omega=  0.84353321 +    0.020702904*Tut1 + 0.0000030695*Tut12 + 0.00000000368*Tut13;
        LLong=  4.40260885 + 2608.814707111*Tut1 + 0.0000053053*Tut12 + 0.00000000031*Tut13;
    elseif (PlanetNum==2)
        % Venus
        a    =  0.723329820;
        ecc  =  0.00677188 -    0.000047766*Tut1 + 0.0000000975*Tut12 + 0.00000000044*Tut13;
        incl =  0.05924803 +    0.000017518*Tut1 - 0.0000000154*Tut12 - 0.00000000012*Tut13;
        LongP=  2.29621986 +    0.024473335*Tut1 - 0.0000187338*Tut12 - 0.00000009276*Tut13;
        Omega=  1.33831707 +    0.015727494*Tut1 + 0.0000070974*Tut12 - 0.00000000140*Tut13;
        LLong=  3.17614670 + 1021.352943053*Tut1 + 0.0000054210*Tut12 + 0.00000000026*Tut13;
    elseif (PlanetNum==3)
        % Earth
        a    =  1.000001018;
        ecc  =  0.01670862 -    0.000042037*Tut1 - 0.0000001236*Tut12 + 0.00000000004*Tut13;
        incl =  0.000;
        Omega=  0.0;
        LongP=  1.79659565 +    0.030011406*Tut1 + 0.0000080219*Tut12 + 0.00000000871*Tut13;
        LLong=  1.75347032 +  628.331966666*Tut1 + 0.0000053002*Tut12 + 0.00000000037*Tut13;
    elseif (PlanetNum==4)
        % Mars
        a    =  1.523679342;
        ecc  =  0.09340062 +    0.000090483*Tut1 - 0.0000000806*Tut12 - 0.00000000035*Tut13;
        incl =  0.03228381 -    0.000010489*Tut1 + 0.0000002227*Tut12 - 0.00000000010*Tut13;
        LongP=  5.86535757 +    0.032132089*Tut1 + 0.0000023588*Tut12 + 0.00000000555*Tut13;
        Omega=  0.86495189 +    0.013475553*Tut1 + 0.0000002801*Tut12 + 0.00000004058*Tut13;
        LLong=  6.20348092 +  334.085627899*Tut1 + 0.0000054275*Tut12 + 0.00000000026*Tut13;
    elseif (PlanetNum==5)
        % Jupiter
        a    =  5.202603191 +   0.0000001913*Tut1;
        ecc  =  0.04849485 +    0.000163244*Tut1 - 0.0000004719*Tut12 - 0.00000000197*Tut13;
        incl =  0.02274635 -    0.000095934*Tut1 + 0.0000000812*Tut12 - 0.00000000007*Tut13;
        LongP=  0.25012853 +    0.028146345*Tut1 + 0.0000179991*Tut12 - 0.00000007974*Tut13;
        Omega=  1.75343528 +    0.017819026*Tut1 + 0.0000070017*Tut12 + 0.00000000993*Tut13;
        LLong=  0.59954650 +   52.993480754*Tut1 + 0.0000039050*Tut12 + 0.00000000044*Tut13;
    elseif (PlanetNum==6)
        % Saturn
        a    =  9.554909596 -   0.0000021389*Tut1;
        ecc  =  0.05550862 -    0.000346818*Tut1  - 0.0000006456*Tut12 + 0.00000000338*Tut13;
        incl =  0.04343912 -    0.000065211*Tut1  - 0.0000002646*Tut12 + 0.00000000155*Tut13;
        LongP=  1.62414732 +    0.034274242*Tut1  + 0.0000146184*Tut12 + 0.00000008550*Tut13;
        Omega=  1.98383764 +    0.015308246*Tut1  - 0.0000021061*Tut12 - 0.00000004154*Tut13;
        LLong=  0.87401675 +   21.354295630*Tut1  + 0.0000090673*Tut12 - 0.00000000005*Tut13;
    elseif (PlanetNum==7)
        % Uranus
        a    = 19.218446062 -   0.0000000372*Tut1 + 0.00000000098*Tut12;
        ecc  =  0.04629590 -    0.000027337*Tut1  + 0.0000000790*Tut12 + 0.00000000025*Tut13;
        incl =  0.01349482 +    0.000013516*Tut1  + 0.0000006543*Tut12 - 0.00000000161*Tut13;
        LongP=  3.01950965 +    0.025942197*Tut1  + 0.0000037437*Tut12 + 0.00000000756*Tut13;
        Omega=  1.29164744 +    0.009095361*Tut1  + 0.0000233843*Tut12 + 0.00000032317*Tut13;
        LLong=  5.48129387 +    7.502543115*Tut1  + 0.0000053117*Tut12 + 0.00000000045*Tut13;
    elseif (PlanetNum==8)
        % Neptune
        a    = 30.110386869 -   0.0000001663*Tut1  + 0.00000000069*Tut12;
        ecc  =  0.00898809 +    0.000006408*Tut1   - 0.0000000008*Tut12;
        incl =  0.03089149 -    0.000162459*Tut1   - 0.0000001236*Tut12 + 0.00000000049*Tut13;
        LongP=  0.83991686 +    0.024893067*Tut1   + 0.0000066179*Tut12 - 0.00000000005*Tut13;
        Omega=  2.30006570 +    0.019237118*Tut1   + 0.0000045389*Tut12 - 0.00000001110*Tut13;
        LLong=  5.31188628 +    3.837687716*Tut1   + 0.0000053976*Tut12 + 0.00000000031*Tut13;
    elseif (PlanetNum==9)
        % Pluto
        a    = 39.53758;
        ecc  =  0.250877;
        incl =  0.2990156;
        LongP=  3.920268;
        Omega=  1.926957;
    end
end

a = a*149597871;

% turn radius to degree
LongP_deg = rad2deg(LongP);
LLong_deg = rad2deg(LLong);
Omega_deg = rad2deg(Omega);
incl_deg = rad2deg(incl);

% make sure 0< angle <360
LongP_deg=wrapTo360(LongP_deg);
LLong_deg=wrapTo360(LLong_deg);
Omega_deg=wrapTo360(Omega_deg);
theta =wrapTo360(LLong_deg-LongP_deg);

LongP = deg2rad(LongP_deg);
LLong = deg2rad(LLong_deg);
Omega = deg2rad(Omega_deg);
theta = deg2rad(theta);

